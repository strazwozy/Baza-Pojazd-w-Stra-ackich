<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title> Baza woz贸w stra偶ackich</title>

<style>
* { box-sizing: border-box; margin:0; padding:0; }
html, body {
    width:100%;
    font-family: Arial, sans-serif;
    background:#1a1a1a;
    color:white;
    padding:20px;
}

h1 {
    text-align:center;
    margin-bottom:20px;
    font-size:32px;
}

#search, #filterWoj, #sortBy {
    margin:10px 5px;
    padding:6px;
    font-size:16px;
    border-radius:6px;
    border:none;
}

#sortBy {
    background:#b30000;
    color:white;
}

/* LISTA */
#lista {
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    justify-content:center;
}

.woz {
    background:#2a2a2a;
    padding:10px;
    border-radius:8px;
    width:200px;
    cursor:pointer;
    transition:transform 0.2s;
}

.woz:hover { transform:scale(1.05); }

.woz img {
    width:100%;
    height:120px;
    object-fit:cover;
    border-radius:6px;
    margin-bottom:8px;
}

.woz-info strong { display:block; font-size:13px; }

.status { font-weight:bold; }

/* PAGINATION */
#pagination {
    display:flex;
    justify-content:center;
    gap:6px;
    margin-top:20px;
    flex-wrap:wrap;
}

.page-btn {
    padding:6px 10px;
    background:#b30000;
    color:white;
    border:none;
    border-radius:6px;
    cursor:pointer;
}

.page-btn.disabled {
    background:#555;
    cursor:default;
}

/* LIGHTBOX */
#lightbox {
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.95);
    justify-content:center;
    align-items:center;
    z-index:1000;
}

#lightboxContent {
    display:flex;
    width:95%;
    height:95%;
    background:#1a1a1a;
    border-radius:15px;
    overflow:hidden;
}

#lightboxImg {
    max-width:75%;
    object-fit:contain;
    background:black;
}

#lightboxInfo {
    flex:1;
    overflow-y:auto;
}

#lightboxTitle {
    background:#e60000;
    padding:15px;
    font-size:26px;
    text-align:center;
}

#lightboxDetails {
    padding:15px;
}

.detail-row {
    display:flex;
    justify-content:space-between;
    border-bottom:1px solid rgba(255,255,255,0.2);
    padding:6px 0;
}

#closeLightbox {
    position:absolute;
    top:15px;
    right:20px;
    font-size:32px;
    background:none;
    border:none;
    color:white;
    cursor:pointer;
}

#prevBtn, #nextBtn {
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    font-size:40px;
    background:rgba(0,0,0,0.5);
    color:white;
    border:none;
    padding:15px;
    cursor:pointer;
}

#prevBtn { left:10px; }
#nextBtn { right:10px; }
</style>
</head>

<body>

<h1> Baza woz贸w stra偶ackich w Polsce</h1>

<input id="search" placeholder="Szukaj: ID, jednostka, marka, rejestracja">
<select id="filterWoj">
    <option value="">Wszystkie wojew贸dztwa</option>
    <option value="Mazowieckie">Mazowieckie</option>
    <option value="Maopolskie">Maopolskie</option>
    <option value="lskie">lskie</option>
</select>

<select id="sortBy">
    <option value="ID">ID</option>
    <option value="Jednostka">Jednostka</option>
    <option value="Marka">Marka</option>
    <option value="Rejestracja">Rejestracja</option>
    <option value="Rok produkcji">Rok</option>
</select>

<div id="lista"></div>
<div id="pagination"></div>

<!-- LIGHTBOX -->
<div id="lightbox">
    <button id="prevBtn">&#8592;</button>
    <div id="lightboxContent">
        <button id="closeLightbox">&times;</button>
        <img id="lightboxImg">
        <div id="lightboxInfo">
            <div id="lightboxTitle"></div>
            <div id="lightboxDetails"></div>
        </div>
    </div>
    <button id="nextBtn">&#8594;</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script>
const csvUrl = 'https://docs.google.com/spreadsheets/d/1-INf04fbUF_z3l7kUvIr4dm1lv7iJWMVmw-ICWbDfkI/export?format=csv';

let wozy = [];
let filtered = [];
let page = 1;
const perPage = 80;
let lightboxIndex = 0;

Papa.parse(csvUrl, {
    download:true,
    header:true,
    skipEmptyLines:true,
    complete: res => {
        wozy = res.data;
        render();
    }
});

function statusColor(s=''){
    s=s.toLowerCase();
    if(s==='czynny') return 'green';
    if(['wycofany ze su偶by','sprzedany','rozbity','spon'].includes(s)) return 'red';
    if(s==='przeniesiony') return 'yellow';
    if(s==='obiekt muzeum') return 'blue';
    if(s==='porzucony') return 'orange';
    return 'white';
}

function render(){
    const search = document.getElementById('search').value.toLowerCase();
    const woj = document.getElementById('filterWoj').value;
    const sortBy = document.getElementById('sortBy').value;

    wozy.sort((a,b)=> (a[sortBy]||'').toString().localeCompare((b[sortBy]||'').toString()));

    filtered = wozy.filter(w=>{
        const s = (w.Jednostka||'')+(w.ID||'')+(w.Marka||'')+(w.Rejestracja||'');
        return s.toLowerCase().includes(search) &&
               (woj==='' || (w.Wojew贸dztwo||'')===woj);
    });

    const list = document.getElementById('lista');
    list.innerHTML='';

    const start=(page-1)*perPage;
    const end=start+perPage;

    filtered.slice(start,end).forEach((w,i)=>{
        const d=document.createElement('div');
        d.className='woz';
        d.innerHTML=`
            <img src="${w.Zdjcie||'https://via.placeholder.com/300x200?text=Brak+zdjcia'}">
            <strong>ID:</strong> ${w.ID||'-'}
            <strong>Jednostka:</strong> ${w.Jednostka||'-'}
            <strong>Status:</strong>
            <span class="status" style="color:${statusColor(w.Status)}">${w.Status||'-'}</span>
        `;
        d.onclick=()=>openLightbox(start+i);
        list.appendChild(d);
    });

    pagination();
}

function pagination(){
    const p=document.getElementById('pagination');
    p.innerHTML='';
    const pages=Math.ceil(filtered.length/perPage);
    for(let i=1;i<=pages;i++){
        const b=document.createElement('button');
        b.textContent=i;
        b.className='page-btn'+(i===page?' disabled':'');
        b.onclick=()=>{ page=i; render(); };
        p.appendChild(b);
    }
}

function openLightbox(i){
    lightboxIndex=i;
    const w=filtered[i];
    document.getElementById('lightboxImg').src=w.Zdjcie||'';
    document.getElementById('lightboxTitle').textContent=w.Marka||'';
    const d=document.getElementById('lightboxDetails');
    d.innerHTML='';
    Object.keys(w).forEach(k=>{
        d.innerHTML+=`<div class="detail-row"><b>${k}</b><span>${w[k]||'-'}</span></div>`;
    });
    document.getElementById('lightbox').style.display='flex';
}

document.getElementById('closeLightbox').onclick=()=>lightbox.style.display='none';
document.getElementById('prevBtn').onclick=()=>openLightbox((lightboxIndex-1+filtered.length)%filtered.length);
document.getElementById('nextBtn').onclick=()=>openLightbox((lightboxIndex+1)%filtered.length);

document.getElementById('search').oninput=()=>{page=1;render();}
document.getElementById('filterWoj').onchange=()=>{page=1;render();}
document.getElementById('sortBy').onchange=render;
</script>

</body>
</html>

</html>

