<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>üöí Baza woz√≥w stra≈ºackich</title>

<style>
* { box-sizing:border-box; margin:0; padding:0; }
html,body { background:#1a1a1a; color:white; font-family:Arial; padding:20px; }

h1 { text-align:center; margin-bottom:20px; }

#search,#filterWoj,#sortBy,#sortDirBtn{
    padding:6px;
    margin:5px;
    font-size:16px;
    border-radius:6px;
    border:1px solid #ccc;
}
#sortBy { background:#b30000; color:white; }
#sortDirBtn { background:#333; color:white; cursor:pointer; }

#lista{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    justify-content:center;
}
.woz{
    width:200px;
    background:#2a2a2a;
    border-radius:8px;
    padding:10px;
    cursor:pointer;
    transition:0.2s;
}
.woz:hover{ transform:scale(1.05); }
.woz img{
    width:100%;
    height:120px;
    object-fit:cover;
    border-radius:6px;
}
.woz-info{ font-size:13px; }

#pagination{
    display:flex;
    justify-content:center;
    gap:6px;
    margin:20px 0;
}
.page-btn{
    padding:6px 10px;
    border:none;
    border-radius:6px;
    background:#b30000;
    color:white;
    cursor:pointer;
}
.page-btn.disabled{
    background:#555;
    cursor:default;
}

/* LIGHTBOX */
#lightbox{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.95);
    z-index:1000;
    justify-content:center;
    align-items:center;
}
#lightboxContent{
    width:95%;
    height:95%;
    display:flex;
    background:#1a1a1a;
    border-radius:15px;
    overflow:hidden;
}
#lightboxImg{
    width:70%;
    object-fit:contain;
    background:black;
}
#lightboxInfo{
    width:30%;
    overflow-y:auto;
}
#lightboxTitle{
    background:#e60000;
    padding:15px;
    text-align:center;
}
#lightboxDetails{
    padding:15px;
}
.detail-row{
    display:flex;
    justify-content:space-between;
    border-bottom:1px solid #333;
    padding:5px 0;
}

#closeLightbox{
    position:absolute;
    top:10px;
    right:20px;
    font-size:32px;
    background:none;
    color:white;
    border:none;
    cursor:pointer;
}
#prevBtn,#nextBtn{
    position:absolute;
    top:50%;
    font-size:50px;
    background:rgba(0,0,0,0.4);
    border:none;
    color:white;
    cursor:pointer;
}
#prevBtn{ left:10px; }
#nextBtn{ right:10px; }
</style>
</head>

<body>

<h1>üöí Baza woz√≥w stra≈ºackich w Polsce</h1>

<input id="search" placeholder="Szukaj...">
<select id="filterWoj">
<option value="">Wszystkie woj.</option>
<option>Ma≈Çopolskie</option>
<option>Mazowieckie</option>
<option>≈ölƒÖskie</option>
</select>

<select id="sortBy">
<option value="ID">ID</option>
<option value="Jednostka">Jednostka</option>
<option value="Marka">Marka</option>
<option value="Rejestracja">Rejestracja</option>
<option value="Rok produkcji">Rok</option>
</select>

<button id="sortDirBtn">‚¨ÜÔ∏è</button>

<div id="lista"></div>
<div id="pagination"></div>

<!-- LIGHTBOX -->
<div id="lightbox">
<button id="prevBtn">‚Üê</button>
<div id="lightboxContent">
<button id="closeLightbox">√ó</button>
<img id="lightboxImg">
<div id="lightboxInfo">
<h2 id="lightboxTitle"></h2>
<div id="lightboxDetails"></div>
</div>
</div>
<button id="nextBtn">‚Üí</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script>
const csvUrl='https://docs.google.com/spreadsheets/d/1-INf04fbUF_z3l7kUvIr4dm1lv7iJWMVmw-ICWbDfkI/export?format=csv';
let currentPage=1;
const itemsPerPage=80;
let filtered=[];
let lightboxIndex=0;
let sortDirection='asc';

Papa.parse(csvUrl,{
download:true,
header:true,
complete:r=>{
window.wozy=r.data;
display();
}
});

function display(){
const search=searchInput.value.toLowerCase();
const woj=filterWoj.value;
const sort=sortBy.value;

filtered=window.wozy.filter(w=>
(!search || Object.values(w).join(' ').toLowerCase().includes(search)) &&
(!woj || w.Wojew√≥dztwo===woj)
);

filtered.sort((a,b)=>{
let A=(a[sort]||'').toString().toLowerCase();
let B=(b[sort]||'').toString().toLowerCase();
let res=A.localeCompare(B,'pl',{numeric:true});
return sortDirection==='asc'?res:-res;
});

renderPage();
}

function renderPage(){
lista.innerHTML='';
pagination.innerHTML='';
let pages=Math.ceil(filtered.length/itemsPerPage);
let start=(currentPage-1)*itemsPerPage;
let page=filtered.slice(start,start+itemsPerPage);

page.forEach((w,i)=>{
let d=document.createElement('div');
d.className='woz';
d.innerHTML=`<img src="${w.Zdjƒôcie||''}"><div class="woz-info">${w.ID}<br>${w.Jednostka}</div>`;
d.onclick=()=>openLightbox(start+i);
lista.appendChild(d);
});

for(let i=1;i<=pages;i++){
let b=document.createElement('button');
b.textContent=i;
b.className='page-btn'+(i===currentPage?' disabled':'');
b.onclick=()=>{currentPage=i;renderPage();};
pagination.appendChild(b);
}
}

function openLightbox(i){
lightboxIndex=i;
let w=filtered[i];
lightboxImg.src=w.Zdjƒôcie||'';
lightboxTitle.textContent=w.Marka||'';
lightboxDetails.innerHTML='';
Object.entries(w).forEach(([k,v])=>{
lightboxDetails.innerHTML+=`<div class="detail-row"><b>${k}</b><span>${v||'-'}</span></div>`;
});
lightbox.style.display='flex';
}

sortBy.onchange=display;
sortDirBtn.onclick=()=>{
sortDirection=sortDirection==='asc'?'desc':'asc';
sortDirBtn.textContent=sortDirection==='asc'?'‚¨ÜÔ∏è':'‚¨áÔ∏è';
display();
};
searchInput.oninput=()=>{currentPage=1;display();};
filterWoj.onchange=()=>{currentPage=1;display();};

closeLightbox.onclick=()=>lightbox.style.display='none';
prevBtn.onclick=()=>openLightbox((lightboxIndex-1+filtered.length)%filtered.length);
nextBtn.onclick=()=>openLightbox((lightboxIndex+1)%filtered.length);
</script>

</body>
</html>

