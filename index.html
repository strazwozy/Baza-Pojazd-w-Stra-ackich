<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>üöí Baza woz√≥w stra≈ºackich</title>

<style>
body {
  font-family: Arial, sans-serif;
  background:#f2f2f2;
  margin:0;
  padding:20px;
}

h1 {
  text-align:center;
  margin-bottom:20px;
}

/* ====== G√ìRNY PANEL ====== */
#controls {
  text-align:center;
  margin-bottom:15px;
}

#search, #filterWoj, #sortBy {
  margin:5px;
  padding:6px;
  font-size:16px;
  border-radius:6px;
  border:1px solid #ccc;
}

#sortBox {
  display:inline-flex;
  align-items:center;
  gap:6px;
}

#sortDir {
  font-size:18px;
  padding:6px 10px;
  border-radius:6px;
  border:none;
  cursor:pointer;
  background:#444;
  color:white;
}

#sortDir:hover {
  background:#666;
}

/* ====== LISTA ====== */
#lista {
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  justify-content:center;
}

.woz {
  background:white;
  padding:10px;
  border-radius:8px;
  width:200px;
  box-shadow:0 2px 5px rgba(0,0,0,0.2);
  cursor:pointer;
}

.woz img {
  width:180px;
  height:120px;
  object-fit:cover;
  border-radius:6px;
  margin-bottom:8px;
}

.woz-info {
  font-size:13px;
}

.status {
  font-weight:bold;
}

/* ====== PAGINACJA ====== */
#pagination {
  margin:20px 0;
  text-align:center;
}

#pagination button {
  padding:6px 12px;
  margin:0 4px;
  border-radius:6px;
  border:none;
  cursor:pointer;
  background:#444;
  color:white;
}

#pagination button:disabled {
  opacity:0.4;
  cursor:default;
}

/* ====== LIGHTBOX ====== */
#lightbox {
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.9);
  justify-content:center;
  align-items:center;
  z-index:1000;
}

#lightboxContent {
  width:95%;
  height:95%;
  background:#1a1a1a;
  display:flex;
  border-radius:15px;
  overflow:hidden;
  color:white;
  position:relative;
}

#lightboxImg {
  max-width:55%;
  object-fit:contain;
  background:black;
}

#lightboxInfo {
  flex:1;
  display:flex;
  flex-direction:column;
  overflow-y:auto;
}

#lightboxTitle {
  background:#e60000;
  padding:16px;
  font-size:28px;
  text-align:center;
}

#lightboxDetails {
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:10px;
  font-size:17px;
}

.detail-row {
  display:flex;
  gap:15px;
  border-bottom:1px solid rgba(255,255,255,0.2);
  padding-bottom:6px;
}

.detail-label {
  min-width:160px;
  font-weight:bold;
}

#closeLightbox {
  position:absolute;
  top:10px;
  right:15px;
  font-size:32px;
  color:white;
  background:none;
  border:none;
  cursor:pointer;
}

#prevBtn, #nextBtn {
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  font-size:50px;
  background:rgba(0,0,0,0.4);
  color:white;
  border:none;
  padding:20px;
  cursor:pointer;
  border-radius:50%;
}

#prevBtn { left:10px; }
#nextBtn { right:10px; }

/* ====== MOBILE ====== */
@media(max-width:900px){
  #lightboxContent {
    flex-direction:column;
  }
  #lightboxImg {
    max-width:100%;
    max-height:50%;
  }
}
</style>
</head>

<body>

<h1>üöí Baza woz√≥w stra≈ºackich w Polsce</h1>

<div id="controls">
  <input type="text" id="search" placeholder="Szukaj...">

  <select id="filterWoj">
    <option value="">Wszystkie wojew√≥dztwa</option>
    <option>Mazowieckie</option>
    <option>Ma≈Çopolskie</option>
    <option>≈ölƒÖskie</option>
    <option>Pomorskie</option>
  </select>

  <div id="sortBox">
    <select id="sortBy">
      <option value="ID">ID</option>
      <option value="Jednostka">Jednostka</option>
      <option value="Marka">Marka</option>
      <option value="Rejestracja">Rejestracja</option>
      <option value="Rok produkcji">Rok produkcji</option>
    </select>
    <button id="sortDir">‚¨Ü</button>
  </div>
</div>

<div id="lista"></div>

<div id="pagination">
  <button id="prevPage">‚Üê Poprzednia</button>
  <span id="pageInfo"></span>
  <button id="nextPage">Nastƒôpna ‚Üí</button>
</div>

<!-- LIGHTBOX -->
<div id="lightbox">
  <button id="prevBtn">‚Üê</button>
  <div id="lightboxContent">
    <button id="closeLightbox">√ó</button>
    <img id="lightboxImg">
    <div id="lightboxInfo">
      <div id="lightboxTitle"></div>
      <div id="lightboxDetails"></div>
    </div>
  </div>
  <button id="nextBtn">‚Üí</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script>
const csvUrl = 'https://docs.google.com/spreadsheets/d/1-INf04fbUF_z3l7kUvIr4dm1lv7iJWMVmw-ICWbDfkI/export?format=csv';

let wozy = [];
let filtered = [];
let page = 1;
const perPage = 80;
let sortDir = 'asc';
let lbIndex = 0;

Papa.parse(csvUrl,{
  download:true,
  header:true,
  complete:r=>{
    wozy = r.data;
    render();
  }
});

function render(){
  const search = searchInput.value.toLowerCase();
  const woj = filterWoj.value;
  const sort = sortBy.value;

  filtered = wozy.filter(w =>
    (!woj || w.Wojew√≥dztwo===woj) &&
    JSON.stringify(w).toLowerCase().includes(search)
  );

  filtered.sort((a,b)=>{
    let A=a[sort]||'', B=b[sort]||'';
    if(sort==='ID'||sort==='Rok produkcji'){
      A=+A||0; B=+B||0;
      return sortDir==='asc'?A-B:B-A;
    }
    return sortDir==='asc'
      ? A.localeCompare(B)
      : B.localeCompare(A);
  });

  const start=(page-1)*perPage;
  const items=filtered.slice(start,start+perPage);

  lista.innerHTML='';
  items.forEach((w,i)=>{
    const d=document.createElement('div');
    d.className='woz';
    d.innerHTML=`
      <img src="${w.Zdjƒôcie||'https://via.placeholder.com/180x120'}">
      <div class="woz-info">
        <b>ID:</b> ${w.ID}<br>
        <b>Jednostka:</b> ${w.Jednostka}<br>
        <b>Marka:</b> ${w.Marka}
      </div>`;
    d.onclick=()=>openLB(start+i);
    lista.appendChild(d);
  });

  pageInfo.textContent = `Strona ${page} / ${Math.ceil(filtered.length/perPage)}`;
  prevPage.disabled = page===1;
  nextPage.disabled = page>=Math.ceil(filtered.length/perPage);
}

function openLB(i){
  lbIndex=i;
  const w=filtered[i];
  lightboxImg.src=w.Zdjƒôcie;
  lightboxTitle.textContent=w.Marka;
  lightboxDetails.innerHTML='';
  Object.entries(w).forEach(([k,v])=>{
    const r=document.createElement('div');
    r.className='detail-row';
    r.innerHTML=`<div class="detail-label">${k}</div><div>${v||'-'}</div>`;
    lightboxDetails.appendChild(r);
  });
  lightbox.style.display='flex';
}

searchInput.oninput=()=>{page=1;render();}
filterWoj.onchange=()=>{page=1;render();}
sortBy.onchange=render;
sortDir.onclick=()=>{
  sortDir.textContent = sortDir.textContent==='‚¨Ü'?'‚¨á':'‚¨Ü';
  sortDir = sortDir==='asc'?'desc':'asc';
  render();
};

prevPage.onclick=()=>{page--;render();}
nextPage.onclick=()=>{page++;render();}
closeLightbox.onclick=()=>lightbox.style.display='none';
prevBtn.onclick=()=>openLB((lbIndex-1+filtered.length)%filtered.length);
nextBtn.onclick=()=>openLB((lbIndex+1)%filtered.length);
</script>

</body>
</html>

