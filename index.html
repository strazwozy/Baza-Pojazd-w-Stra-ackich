<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title> Baza woz贸w stra偶ackich</title>

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{background:#1a1a1a;color:#fff;font-family:Arial;padding:20px}

h1{text-align:center;margin-bottom:15px}

#search,#filterWoj,#sortBy,#sortDir{
padding:6px;
margin:5px;
border-radius:6px;
border:1px solid #ccc;
}

#sortBy,#sortDir{background:#b30000;color:white}

#counter{text-align:center;margin:10px 0;font-weight:bold}

#lista{
display:flex;
flex-wrap:wrap;
gap:10px;
justify-content:center;
}

.woz{
width:220px;
background:#2a2a2a;
border-radius:8px;
padding:10px;
cursor:pointer;
transition:.2s;
}
.woz:hover{transform:scale(1.05)}

.woz img{
width:100%;
height:120px;
object-fit:cover;
border-radius:6px;
margin-bottom:8px;
}

.woz-info strong{display:block;font-size:13px}

.status{font-weight:bold}

#pagination{
display:flex;
gap:5px;
justify-content:center;
margin-top:15px;
flex-wrap:wrap;
}

.page-btn{
padding:6px 10px;
background:#b30000;
color:white;
border:none;
border-radius:6px;
cursor:pointer;
}
.page-btn.disabled{background:#555;cursor:default}

#lightbox{
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,.95);
z-index:1000;
align-items:center;
justify-content:center;
}

#lightboxContent{
background:#1a1a1a;
width:95%;
height:95%;
display:flex;
border-radius:15px;
overflow:hidden;
position:relative;
}

#lightboxImg{max-width:70%;object-fit:contain;background:black}

#lightboxInfo{
flex:1;
overflow-y:auto;
}

#lightboxTitle{
background:#e60000;
padding:15px;
font-size:24px;
text-align:center;
}

#lightboxDetails{padding:15px}

.detail-row{
display:flex;
border-bottom:1px solid rgba(255,255,255,.2);
padding:5px 0;
}

.detail-label{width:140px;font-weight:bold}
.detail-value{flex:1}

.osp-link{
text-decoration:underline;
cursor:pointer;
color:inherit;
}

#closeLightbox{
position:absolute;
top:10px;
right:15px;
background:#b30000;
width:40px;
height:40px;
border-radius:50%;
font-size:30px;
display:flex;
align-items:center;
justify-content:center;
cursor:pointer;
}

#prevBtn,#nextBtn{
position:absolute;
top:50%;
transform:translateY(-50%);
background:rgba(0,0,0,.4);
color:white;
border:none;
font-size:40px;
width:50px;
height:50px;
border-radius:50%;
cursor:pointer;
}
#prevBtn{left:10px}
#nextBtn{right:10px}
</style>
</head>

<body>

<h1> Baza woz贸w stra偶ackich</h1>

<input id="search" placeholder="Szukaj...">
<select id="filterWoj">
<option value="">Wszystkie woj.</option>
<option>Mazowieckie</option>
<option>Maopolskie</option>
<option>lskie</option>
</select>

<select id="sortBy">
<option value="ID">ID</option>
<option value="Jednostka">Jednostka</option>
<option value="Marka">Marka</option>
<option value="Rok produkcji">Rok</option>
</select>

<select id="sortDir">
<option value="asc">猬锔</option>
<option value="desc">猬锔</option>
</select>

<div id="counter"></div>
<div id="lista"></div>
<div id="pagination"></div>

<!-- LIGHTBOX -->
<div id="lightbox">
<button id="prevBtn">&#8592;</button>

<div id="lightboxContent">
<span id="closeLightbox">&times;</span>
<img id="lightboxImg">
<div id="lightboxInfo">
<h2 id="lightboxTitle"></h2>
<div id="lightboxDetails"></div>
</div>
</div>

<button id="nextBtn">&#8594;</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script>
const csvUrl='https://docs.google.com/spreadsheets/d/1-INf04fbUF_z3l7kUvIr4dm1lv7iJWMVmw-ICWbDfkI/export?format=csv';
let wozy=[],filtered=[],page=1,perPage=24,lbIndex=0,filterField=null;

Papa.parse(csvUrl,{
download:true,header:true,
complete:r=>{wozy=r.data;render()}
});

function render(){
const q=search.value.toLowerCase();
const woj=filterWoj.value;
filtered=wozy.filter(w=>{
let ok=true;
if(q){
if(filterField && w[filterField]) ok=w[filterField].toLowerCase().includes(q);
else ok=Object.values(w).join(' ').toLowerCase().includes(q);
}
return ok && (!woj||w.Wojew贸dztwo===woj);
});

counter.textContent=`cznie woz贸w: ${filtered.length}`;

const start=(page-1)*perPage;
lista.innerHTML='';
filtered.slice(start,start+perPage).forEach((w,i)=>{
const d=document.createElement('div');
d.className='woz';
d.innerHTML=`
<img src="${w.Zdjcie||''}">
<div class="woz-info">
<strong>ID:</strong> ${w.ID||'-'}
<strong>Jednostka:</strong> ${w.Jednostka||'-'}
<strong>Marka:</strong> ${w.Marka||'-'}
<strong>Rejestracja:</strong> ${w.Rejestracja||'-'}
<strong>Rok:</strong> ${w['Rok produkcji']||'-'}
</div>`;
d.onclick=()=>openLB(start+i);
lista.appendChild(d);
});

pagination.innerHTML='';
const pages=Math.ceil(filtered.length/perPage);
for(let i=1;i<=pages;i++){
const b=document.createElement('button');
b.textContent=i;
b.className='page-btn'+(i===page?' disabled':'');
b.onclick=()=>{page=i;render()};
pagination.appendChild(b);
}
}

function openLB(i){
lbIndex=i;
const w=filtered[i];
lightbox.style.display='flex';
lightboxImg.src=w.Zdjcie||'';
lightboxTitle.textContent=`${w.Marka||'-'} (${w.ID||'-'})`;
lightboxDetails.innerHTML='';

[
['Podstawowe',['ID','Marka','Rok produkcji','Rejestracja','Typ']],
['Lokalizacja',['Jednostka','Wojew贸dztwo','Powiat']],
['Status',['Status']],
['Inne',['Inne']]
].forEach(sec=>{
const h=document.createElement('h3');h.textContent=sec[0];
lightboxDetails.appendChild(h);

sec[1].forEach(f=>{
if(!w[f])return;
const r=document.createElement('div');
r.className='detail-row';
const v=document.createElement('div');
v.className='detail-value';

if(f==='Inne'){
const rx=/\b(?:OSP|JRG|PSP|KSRG|ZSP|WSP|LSRG|ZSR)\s+[\w\s贸偶藕]+/gi;
v.innerHTML=w[f].replace(rx,m=>`<span class="osp-link">${m}</span>`);
v.querySelectorAll('.osp-link').forEach(el=>{
el.onclick=()=>{
search.value=el.textContent.replace(/^(OSP|JRG|PSP|KSRG)\s+/,'');
filterField='Jednostka';
page=1;render();lightbox.style.display='none';
};
});
}else{
v.textContent=w[f];
v.style.cursor='pointer';
v.onclick=()=>{
search.value=w[f];
filterField=f;
page=1;render();lightbox.style.display='none';
};
}

r.innerHTML=`<div class="detail-label">${f}</div>`;
r.appendChild(v);
lightboxDetails.appendChild(r);
});
});
}

closeLightbox.onclick=()=>lightbox.style.display='none';
prevBtn.onclick=()=>openLB((lbIndex-1+filtered.length)%filtered.length);
nextBtn.onclick=()=>openLB((lbIndex+1)%filtered.length);

document.onkeydown=e=>{
if(lightbox.style.display!=='flex')return;
if(e.key==='ArrowLeft')prevBtn.click();
if(e.key==='ArrowRight')nextBtn.click();
if(e.key==='Escape')closeLightbox.click();
};

search.oninput=()=>{page=1;filterField=null;render()};
filterWoj.onchange=()=>{page=1;render()};
sortBy.onchange=render;
sortDir.onchange=render;
</script>
</body>
</html>



