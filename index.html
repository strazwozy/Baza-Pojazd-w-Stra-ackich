<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>üöí Baza woz√≥w stra≈ºackich</title>
<style>
body { font-family: Arial; background:#f2f2f2; padding:20px; }
h1 { text-align: center; }
#search, #filterWoj, .sort-buttons button, #pagination button { margin:10px 5px; padding:5px; font-size: 16px; }
#lista { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
.woz { background:white; padding:10px; border-radius:8px; display:flex; flex-direction: column; align-items: center; width: 200px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);}
.woz img { width: 180px; height: 120px; border-radius:6px; margin-bottom:10px; object-fit: cover; cursor:pointer; }
.woz-info { display:flex; flex-direction: column; gap:3px; text-align: left; width: 100%; }
.woz-info strong { display:inline-block; width: 80px; }

.sort-buttons button {
    background-color: #c8102e; 
    color: white;
    border: none;
    padding: 8px 12px;
    margin: 0 5px;
    font-size: 14px;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.2s;
}
.sort-buttons button:hover { background-color: #ff4d4d; }

#pagination button {
    background-color: #c8102e;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    margin: 0 5px;
    transition: background 0.2s;
}
#pagination button:hover { background-color: #ff4d4d; }

/* Lightbox */
#lightbox {
    display: none;
    position: fixed;
    z-index: 999;
    top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,0,0.9);
    justify-content: center;
    align-items: center;
}
#lightbox-content {
    display: flex;
    background: #222;
    border-radius: 10px;
    padding: 20px;
    max-width: 90%;
    max-height: 90%;
    gap: 20px;
}
#lightbox img { max-width: 50%; max-height: 80vh; border-radius:8px; }
#lightbox .details { color:white; max-width:50%; overflow-y:auto; }
#lightbox .details p { margin: 4px 0; }
#lightbox .close { position:absolute; top:20px; right:30px; font-size:30px; color:white; cursor:pointer; }
#lightbox .nav { position:absolute; top:50%; transform:translateY(-50%); font-size:40px; color:white; cursor:pointer; padding:10px; user-select:none; }
#lightbox .prev { left:20px; }
#lightbox .next { right:20px; }

/* Responsywno≈õƒá na telefony */
@media (max-width: 600px) {
    #lista { flex-direction: column; align-items: center; }
    .woz { width: 90%; }
    .woz img { width: 100%; height: auto; }
    .woz-info strong { width: 100px; }
    #lightbox-content { flex-direction: column; max-height: 80%; }
    #lightbox img, #lightbox .details { max-width: 100%; }
}
</style>
</head>
<body>

<h1>üöí Baza woz√≥w stra≈ºackich w Polsce</h1>

<input type="text" id="search" placeholder="Szukaj jednostki, ID, rejestracji lub marki...">

<select id="filterWoj">
  <option value="">Wszystkie wojew√≥dztwa</option>
  <option value="Ma≈Çopolskie">Ma≈Çopolskie</option>
  <option value="Mazowieckie">Mazowieckie</option>
  <option value="Pomorskie">Pomorskie</option>
  <option value="Wielkopolskie">Wielkopolskie</option>
  <option value="Dolno≈õlƒÖskie">Dolno≈õlƒÖskie</option>
  <option value="≈ölƒÖskie">≈ölƒÖskie</option>
  <option value="≈Å√≥dzkie">≈Å√≥dzkie</option>
  <option value="Lubelskie">Lubelskie</option>
  <option value="Lubuskie">Lubuskie</option>
  <option value="Opolskie">Opolskie</option>
  <option value="Podkarpackie">Podkarpackie</option>
  <option value="Podlaskie">Podlaskie</option>
  <option value="≈öwiƒôtokrzyskie">≈öwiƒôtokrzyskie</option>
  <option value="Warmi≈Ñsko-Mazurskie">Warmi≈Ñsko-Mazurskie</option>
  <option value="Zachodniopomorskie">Zachodniopomorskie</option>
</select>

<div class="sort-buttons">
  <button id="sortID">ID ‚Üë</button>
  <button id="sortJednostka">Jednostka ‚Üë</button>
  <button id="sortMarka">Marka ‚Üë</button>
  <button id="sortRejestracja">Rejestracja ‚Üë</button>
</div>

<div id="lista"></div>

<div id="pagination">
  <button id="prevPage">Poprzednia</button>
  <span id="pageInfo">1</span>
  <button id="nextPage">Nastƒôpna</button>
</div>

<!-- Lightbox -->
<div id="lightbox">
  <span class="close">&times;</span>
  <span class="nav prev">&#10094;</span>
  <span class="nav next">&#10095;</span>
  <div id="lightbox-content">
    <img src="">
    <div class="details"></div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script>
const csvUrl = 'https://docs.google.com/spreadsheets/d/1-INf04fbUF_z3l7kUvIr4dm1lv7iJWMVmw-ICWbDfkI/export?format=csv';
let sortField = 'ID', sortAsc = true, currentPage = 1, perPage = 80;
let currentLightboxIndex = 0;

Papa.parse(csvUrl, {
    download: true,
    header: true,
    skipEmptyLines: true,
    complete: function(results) {
        window.wozy = results.data;
        displayWozow();
    }
});

function displayWozow() {
    const lista = document.getElementById('lista');
    const search = document.getElementById('search').value.toLowerCase();
    const wojFilter = document.getElementById('filterWoj').value;
    lista.innerHTML = '';

    let filtered = window.wozy.filter(w => (
        (w.Jednostka && w.Jednostka.toLowerCase().includes(search)) ||
        (w.ID && w.ID.toString().includes(search)) ||
        (w.Rejestracja && w.Rejestracja.toLowerCase().includes(search)) ||
        (w.Marka && w.Marka.toLowerCase().includes(search))
    ) && (wojFilter === '' || w.Wojew√≥dztwo === wojFilter));

    filtered.sort((a,b)=>{
        let valA=a[sortField]||'', valB=b[sortField]||'';
        if(sortField==='ID') return sortAsc ? Number(valA)-Number(valB) : Number(valB)-Number(valA);
        return sortAsc ? valA.toString().localeCompare(valB.toString()) : valB.toString().localeCompare(valA.toString());
    });

    const start=(currentPage-1)*perPage, end=start+perPage;
    const pageData=filtered.slice(start,end);

    pageData.forEach((w,i)=>{
        const div=document.createElement('div');
        div.className='woz';
        div.innerHTML=`
            <img src="${w.Zdjƒôcie||'https://via.placeholder.com/180x120?text=Brak+zdjƒôcia'}" alt="${w.Jednostka}">
            <div class="woz-info">
                <strong>ID:</strong> ${w.ID||'-'}
                <strong>Jednostka:</strong> ${w.Jednostka||'-'}
                <strong>Wojew√≥dztwo:</strong> ${w.Wojew√≥dztwo||'-'}
                <strong>Powiat:</strong> ${w.Powiat||'-'}
                <strong>Marka:</strong> ${w.Marka||'-'}
                <strong>Rok:</strong> ${w['Rok produkcji']||'-'}
                <strong>Status:</strong> ${w.Status||'-'}
                <strong>Rejestracja:</strong> ${w.Rejestracja||'-'}
                <strong>Inne:</strong> ${w.Inne||'-'}
            </div>
        `;
        lista.appendChild(div);

        div.querySelector('img').addEventListener('click', () => {
            currentLightboxIndex = window.wozy.indexOf(w);
            showLightbox();
        });
    });

    document.getElementById('pageInfo').textContent = `${currentPage} / ${Math.ceil(filtered.length/perPage) || 1}`;
}

function showLightbox() {
    const w = window.wozy[currentLightboxIndex];
    document.querySelector('#lightbox img').src = w.Zdjƒôcie || 'https://via.placeholder.com/600x400?text=Brak+zdjƒôcia';
    document.querySelector('#lightbox .details').innerHTML = `
        <p><strong>ID:</strong> ${w.ID||'-'}</p>
        <p><strong>Jednostka:</strong> ${w.Jednostka||'-'}</p>
        <p><strong>Wojew√≥dztwo:</strong> ${w.Wojew√≥dztwo||'-'}</p>
        <p><strong>Powiat:</strong> ${w.Powiat||'-'}</p>
        <p><strong>Marka:</strong> ${w.Marka||'-'}</p>
        <p><strong>Rok:</strong> ${w['Rok produkcji']||'-'}</p>
        <p><strong>Status:</strong> ${w.Status||'-'}</p>
        <p><strong>Rejestracja:</strong> ${w.Rejestracja||'-'}</p>
        <p><strong>Inne:</strong> ${w.Inne||'-'}</p>
    `;
    document.getElementById('lightbox').style.display='flex';
}

document.getElementById('search').addEventListener('input', ()=>{currentPage=1; displayWozow();});
document.getElementById('filterWoj').addEventListener('change', ()=>{currentPage=1; displayWozow();});

document.getElementById('sortID').addEventListener('click', ()=>{sortField==='ID'?sortAsc=!sortAsc:(sortField='ID',sortAsc=true); currentPage=1; displayWozow();});
document.getElementById('sortJednostka').addEventListener('click', ()=>{sortField==='Jednostka'?sortAsc=!sortAsc:(sortField='Jednostka',sortAsc=true); currentPage=1; displayWozow();});
document.getElementById('sortMarka').addEventListener('click', ()=>{sortField==='Marka'?sortAsc=!sortAsc:(sortField='Marka',sortAsc=true); currentPage=1; displayWozow();});
document.getElementById('sortRejestracja').addEventListener('click', ()=>{sortField==='Rejestracja'?sortAsc=!sortAsc:(sortField='Rejestracja',sortAsc=true); currentPage=1; displayWozow();});

document.getElementById('prevPage').addEventListener('click', ()=>{if(currentPage>1){currentPage--; displayWozow();}});
document.getElementById('nextPage').addEventListener('click', ()=>{currentPage++; displayWozow();});

document.querySelector('#lightbox .close').addEventListener('click', ()=>{document.getElementById('lightbox').style.display='none';});
document.getElementById('lightbox').addEventListener('click', e=>{if(e.target===document.getElementById('lightbox')) document.getElementById('lightbox').style.display='none';});
document.querySelector('#lightbox .prev').addEventListener('click', ()=>{currentLightboxIndex=(currentLightboxIndex-1+window.wozy.length)%window.wozy.length; showLightbox();});
document.querySelector('#lightbox .next').addEventListener('click', ()=>{currentLightboxIndex=(currentLightboxIndex+1)%window.wozy.length; showLightbox();});
</script>

</body>
</html>
