<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>üöí Baza woz√≥w stra≈ºackich</title>
<style>
body { font-family: Arial; background:#f2f2f2; padding:20px; }
h1 { text-align: center; }
#search, #filterWoj, button { margin:10px 5px; padding:5px; font-size: 16px; }
#lista { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
.woz { background:white; padding:10px; border-radius:8px; display:flex; flex-direction: column; align-items: center; width: 200px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);}
.woz img { 
    width: 180px;     
    height: 120px;    
    border-radius:6px; 
    margin-bottom:10px; 
    object-fit: cover; 
}
.woz-info { display:flex; flex-direction: column; gap:3px; text-align: left; width: 100%; }
.woz-info strong { display:inline-block; width: 80px; }
.sort-buttons { text-align: center; margin:10px 0; }
</style>
</head>
<body>

<h1>üöí Baza woz√≥w stra≈ºackich w Polsce</h1>

<input type="text" id="search" placeholder="Szukaj jednostki, ID lub rejestracji...">

<select id="filterWoj">
  <option value="">Wszystkie wojew√≥dztwa</option>
  <option value="Ma≈Çopolskie">Ma≈Çopolskie</option>
  <option value="Mazowieckie">Mazowieckie</option>
  <option value="Pomorskie">Pomorskie</option>
  <option value="Wielkopolskie">Wielkopolskie</option>
  <option value="Dolno≈õlƒÖskie">Dolno≈õlƒÖskie</option>
  <option value="≈ölƒÖskie">≈ölƒÖskie</option>
  <option value="≈Å√≥dzkie">≈Å√≥dzkie</option>
  <option value="Lubelskie">Lubelskie</option>
  <option value="Lubuskie">Lubuskie</option>
  <option value="Opolskie">Opolskie</option>
  <option value="Podkarpackie">Podkarpackie</option>
  <option value="Podlaskie">Podlaskie</option>
  <option value="≈öwiƒôtokrzyskie">≈öwiƒôtokrzyskie</option>
  <option value="Warmi≈Ñsko-Mazurskie">Warmi≈Ñsko-Mazurskie</option>
  <option value="Zachodniopomorskie">Zachodniopomorskie</option>
</select>

<div class="sort-buttons">
  <button id="sortID">ID ‚Üë</button>
  <button id="sortJednostka">Jednostka ‚Üë</button>
  <button id="sortMarka">Marka ‚Üë</button>
</div>

<div id="lista"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script>
const csvUrl = 'https://docs.google.com/spreadsheets/d/1-INf04fbUF_z3l7kUvIr4dm1lv7iJWMVmw-ICWbDfkI/export?format=csv';

let sortField = 'ID';
let sortAsc = true;

Papa.parse(csvUrl, {
    download: true,
    header: true,
    skipEmptyLines: true,
    complete: function(results) {
        console.log("Wczytane wozki:", results.data);
        window.wozy = results.data;
        displayWozow();
    }
});

function displayWozow() {
    const lista = document.getElementById('lista');
    const search = document.getElementById('search').value.toLowerCase();
    const wojFilter = document.getElementById('filterWoj').value;
    lista.innerHTML = '';

    // sortowanie
    window.wozy.sort((a, b) => {
        let valA = a[sortField] || '';
        let valB = b[sortField] || '';
        if(sortField === 'ID') {
            return sortAsc ? Number(valA)-Number(valB) : Number(valB)-Number(valA);
        }
        return sortAsc ? valA.toString().localeCompare(valB.toString()) : valB.toString().localeCompare(valA.toString());
    });

    let count = 0;
    window.wozy.forEach(w => {
        if(count >= 80) return; // limit 80 woz√≥w

        if (
            (w.Jednostka && w.Jednostka.toLowerCase().includes(search)) ||
            (w.ID && w.ID.toString().includes(search)) ||
            (w.Rejestracja && w.Rejestracja.toLowerCase().includes(search))
        ) {
            const div = document.createElement('div');
            div.className = 'woz';
            div.innerHTML = `
                <img src="${w.Zdjƒôcie || 'https://via.placeholder.com/180x120?text=Brak+zdjƒôcia'}" alt="${w.Jednostka}">
                <div class="woz-info">
                    <strong>ID:</strong> ${w.ID || '-'}
                    <strong>Jednostka:</strong> ${w.Jednostka || '-'}
                    <strong>Wojew√≥dztwo:</strong> ${w.Wojew√≥dztwo || '-'}
                    <strong>Powiat:</strong> ${w.Powiat || '-'}
                    <strong>Marka:</strong> ${w.Marka || '-'}
                    <strong>Rok:</strong> ${w['Rok produkcji'] || '-'}
                    <strong>Status:</strong> ${w.Status || '-'}
                    <strong>Rejestracja:</strong> ${w.Rejestracja || '-'}
                    <strong>Inne:</strong> ${w.Inne || '-'}
                </div>
            `;
            lista.appendChild(div);
            count++;
        }
    });
}

// eventy
document.getElementById('search').addEventListener('input', displayWozow);
document.getElementById('filterWoj').addEventListener('change', displayWozow);

// sortowanie klikniƒôciem
document.getElementById('sortID').addEventListener('click', () => {
    if(sortField==='ID') sortAsc=!sortAsc; else {sortField='ID'; sortAsc=true;}
    document.getElementById('sortID').textContent = `ID ${sortAsc?'‚Üë':'‚Üì'}`;
    displayWozow();
});
document.getElementById('sortJednostka').addEventListener('click', () => {
    if(sortField==='Jednostka') sortAsc=!sortAsc; else {sortField='Jednostka'; sortAsc=true;}
    document.getElementById('sortJednostka').textContent = `Jednostka ${sortAsc?'‚Üë':'‚Üì'}`;
    displayWozow();
});
document.getElementById('sortMarka').addEventListener('click', () => {
    if(sortField==='Marka') sortAsc=!sortAsc; else {sortField='Marka'; sortAsc=true;}
    document.getElementById('sortMarka').textContent = `Marka ${sortAsc?'‚Üë':'‚Üì'}`;
    displayWozow();
});
</script>

</body>
</html>
